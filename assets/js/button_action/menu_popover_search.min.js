var urlTo=$("#base_url").val();$(".popovers").popover({container:"body",animation:!0,placement:"right",trigger:"manual",html:!0,title:function(){return $("#popover-head").html()},content:function(){return $(".popover-content"+this.id).html()}}).bind("contextmenu",function(e){return $(this).popover("show"),$("#vista_archivos").mCustomScrollbar("disable"),e.stopPropagation(),!1}),$(".popovers").on("contextmenu",function(e){$(".popovers").not(this).popover("hide")}),$(document).click(function(e){0==e.button&&($(".popovers").popover("hide"),$("#vista_archivos").mCustomScrollbar("update"))}),$(document).keydown(function(e){27==e.keyCode&&($(".popover").popover("hide"),$("#vista_archivos").mCustomScrollbar("update"))});var $file="",$ruta="";function open_file(e){var t=document.getElementById(e),o=t.dataset.att;$file=o,$ruta=t.dataset.ruta,$.ajax({url:urlTo+"open/"+$.base64.encode(o),type:"POST",beforeSend:function(){$("#here_fake").show(),$("#here_fake").fakeLoader({timeToHide:12e6,spinner:"spinner6"})},success:function(e){$("#here_fake").hide(),$("textarea").text(e),$("#nombre_file_for_modal").html("<strong>Archivo:</strong> "+o),$("#myModalOpen").modal("show")}})}function guardar_archivo(e,t,o){$.ajax({url:urlTo+"guardarFile",type:"POST",data:{rutaarchivo:e,contenido:t,ruta_actual:o},success:function(e){$.alert({columnClass:"small",icon:"glyphicon glyphicon-ok",type:"green",theme:"modern",closeIcon:!0,animation:"rotate",closeAnimation:"scale",title:"&Eacute;xito",content:e,buttons:{ok:{text:"Aceptar",btnClass:"btn-default",action:function(){}}}})}})}function salvarFichero(){$.ajax({url:urlTo+"open/"+$.base64.encode($file),type:"POST",success:function(e){tinymce.get("text").getContent()!=e?$.confirm({columnClass:"small",icon:"glyphicon glyphicon-warning-sign",title:"Informaci√≥n",content:"Desea guardar los cambios realizados.",boxWidth:"450px",useBootstrap:!1,type:"orange",theme:"dark",closeIcon:!0,buttons:{save:{text:"Guardar",keys:["enter","shift"],btnClass:"btn-warning",action:function(){$.ajax({url:urlTo+"guardarFile",type:"POST",data:{rutaarchivo:$file,contenido:tinymce.get("text").getContent(),ruta_actual:$ruta},success:function(e){$("#myModalOpen").modal("hide"),location.reload()}})}},no_save:{text:"No Guardar",btnClass:"btn-default",action:function(){$("#myModalOpen").modal("hide"),location.reload()}},cancel:{text:"Cancelar",btnClass:"btn-default",action:function(){}}}}):($("#myModalOpen").modal("hide"),location.reload())}})}function getFileRuta(e){return e.slice(0,e.lastIndexOf("/"))}function abrirFile(e){$file=e,$ruta=getFileRuta(e)+"/",$.ajax({url:urlTo+"open/"+$.base64.encode(e),type:"POST",beforeSend:function(){$("#here_fake").show(),$("#here_fake").fakeLoader({timeToHide:12e6,spinner:"spinner6"})},success:function(t){$("#here_fake").hide(),$("textarea").text(t),$("#nombre_file_for_modal").html("<strong>Archivo:</strong> "+e),$("#myModalOpen").modal("show")}})}$("#myModalOpen").on("show.bs.modal",function(){tinymce.init({selector:"textarea",theme:"modern",height:262,statusbar:!1,language:"es",toolbar:!1,setup:function(e){e.addMenuItem("myitem",{text:"Guardar Archivo",context:"file",icon:"save",plugins:"save",onclick:function(){guardar_archivo($file,tinymce.get("text").getContent(),$ruta)}}),e.addMenuItem("myitem1",{text:"Salir",context:"file",icon:"",image:urlTo+"assets/img/salir.jpg",onclick:function(){salvarFichero()}})}})}),$("#close_open_file").on("click",function(e){e.stopPropagation(),salvarFichero()}),$("#myModalOpen").on("hidden.bs.modal",function(){tinymce.remove("textarea")});